<!DOCTYPE html>
<html>
	<head>
		<title>Photoshop脚本 > 拼合多张小图为大图并生成小图坐标信息</title>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
<meta name="robots" content="all">
<meta name="author" content="http://weibo.com/tapinfinity">
<meta name="keywords" content="photoshop,photoshop脚本,ps,ps脚本,photoshop教程,ps教程,photoshop视频,ps视频,photoshop动作,ps动作,photoshop批处理,ps批处理" />
<meta name="description" content="本站是全球唯一一个向您详细讲解Photoshop脚本的站点。本站超酷的教程帮助您快速上手Photohsop脚本！学会Photoshop脚本，可以大幅度提高您的工作效率！" />
<link rel="stylesheet" type="text/css" href="../source/css.css">
<script>
	window.onscroll = function()
	{ 
		var t = document.documentElement.scrollTop || document.body.scrollTop;  
		
		if( t >= 62 ) 
		{ 
			//alert(t);
			if(document.getElementById("topMenuFloat"))
			{
				document.getElementById("topMenuFloat").style.top = t +"px";
			}
			else
			{
				var newNode = document.getElementById("topMenu").cloneNode(true);
				newNode.id = "topMenuFloat";
				document.body.appendChild(newNode);
				newNode.style.position = "absolute";
				newNode.style.top = t +"px";
			}
			//document.getElementById("topMenu").style.display="block";
			//document.getElementById("topMenu").style.top = t +"px";
		} 
		else 
		{ 
			if(document.getElementById("topMenuFloat"))
			{
				document.getElementById("topMenuFloat").parentNode.removeChild(document.getElementById("topMenuFloat"));
			}
		} 

		if( t >= (152-50) ) 
		{
			if(document.getElementById("leftMenuFloat"))
			{
				document.getElementById("leftMenuFloat").style.top = t + 50 +"px";
			}
			else
			{
				var newNode = document.getElementById("leftPart").cloneNode(true);
				
				newNode.id = "leftMenuFloat";
				document.body.appendChild(newNode);

				var arr = document.getElementById('leftMenuFloat').childNodes;
				for(var i=0; i<arr.length; i++)
				{
					if(arr[i].id == "leftMenuAdPart")
					{
						arr[i].parentNode.removeChild(arr[i]);
						break;
					}
				}
				newNode.style.position = "absolute";
				newNode.style.top = t + 50 +"px";
				newNode.style.left = document.getElementById("leftPart").offsetLeft + "px";
			}
		}
		else
		{
			if(document.getElementById("leftMenuFloat"))
			{
				document.getElementById("leftMenuFloat").parentNode.removeChild(document.getElementById("leftMenuFloat"));
			}
		}
	} 
	
	function closeAd(obj)
	{
		obj.parentNode.parentNode.removeChild(obj.parentNode);
	}
</script>	</head>

	<body>
		<div class="divHead">
	<div class="divHeadContent">
		<div class="divHeadContentLogo"><a href="/"><img href="/" src="../images/logo.png"/></a></div>
		<div class="divHeadContentRight"><a href="http://weibo.com/tapinfinity" target="_blank"><img src="../images/sina.png"/></a></div>

	</div>
</div>
<div class="divHeadSplitter">&nbsp;</div>
<div id="topMenu" class="divHeadMenu">
	<div class="divHeadMenuContent">
		<a href="menu1lesson1.html">初识Ps脚本</a>
		<a href="menu2lesson1.html">文档操作</a>
		<a href="menu3lesson1.html">图像处理</a>
		<a href="menu4lesson1.html">使用图层</a>
		<a href="menu5lesson1.html">使用选区</a>
		<a href="menu6lesson1.html">通道基础</a>
		<a href="menu7lesson1.html">神奇滤镜</a>
		<a href="menu8lesson1.html">综合实例</a>
		<a href="menu9lesson1.html">JS脚本入门</a>
	</div>
</div>

<div class="divMenuPath">
	<div id="pageTitle" class="divMenuPathContent">
		首页 > 
	</div>
</div>
<script>
//document.getElementById('contentTitle').innerHTML = document.title;

var topMenu = document.getElementById('topMenu');
var topMenuAs = topMenu.getElementsByTagName('a');
for(var i=0; i<topMenuAs.length; i++)
{
	topMenuAs[i].className = ''; 
}

var mainTitle = "";
var url = window.location.href;
if(url.indexOf('menu1lesson') > -1)
{
	topMenuAs[0].className = 'active'; 
	mainTitle = "<a href='/psscript/menu1lesson1.html'>初识Ps脚本</a>";
}
else if(url.indexOf('menu2lesson') > -1)
{
	topMenuAs[1].className = 'active'; 
	mainTitle = "<a href='/psscript/menu2lesson1.html'>文档操作</a>";
}
else if(url.indexOf('menu3lesson') > -1)
{
	topMenuAs[2].className = 'active'; 
	mainTitle = "<a href='/psscript/menu3lesson1.html'>图像处理</a>";
}
else if(url.indexOf('menu4lesson') > -1)
{
	topMenuAs[3].className = 'active'; 
	mainTitle = "<a href='/psscript/menu4lesson1.html'>使用图层</a>";
}
else if(url.indexOf('menu5lesson') > -1)
{
	topMenuAs[4].className = 'active'; 
	mainTitle = "<a href='/psscript/menu5lesson1.html'>使用选区</a>";
}
else if(url.indexOf('menu6lesson') > -1)
{
	topMenuAs[5].className = 'active'; 
	mainTitle = "<a href='/psscript/menu6lesson1.html'>通道基础</a>";
}
else if(url.indexOf('menu7lesson') > -1)
{
	topMenuAs[6].className = 'active'; 
	mainTitle = "<a href='/psscript/menu7lesson1.html'>神奇滤镜</a>";
}
else if(url.indexOf('menu8lesson') > -1)
{
	topMenuAs[7].className = 'active'; 
	mainTitle = "<a href='/psscript/menu8lesson1.html'>综合实例</a>";
}
else if(url.indexOf('menu9lesson') > -1)
{
	topMenuAs[8].className = 'active'; 
	mainTitle = "<a href='/psscript/menu9lesson1.html'>JS脚本入门</a>";
}

document.getElementById('pageTitle').innerHTML = '<a href="/">首页</a> > '+mainTitle+' > ' + document.title.split(' > ')[1];
</script>		<div class="divBody">
			<div class="divBodyContent">
				<div id="leftPart" class="divBodyContentLeft">
					<div id="leftMenu" class="menu">
		<p class="title">综合实例</p>
	<p>
		<a href="menu8lesson1.html" title="更改默认历史纪录数量">更改默认历史纪录数量</a><br/>
		<a href="menu8lesson2.html" title="参考线的使用">参考线的使用</a><br/>
		<a href="menu8lesson3.html" title="输出当前文档的所有历史状态">输出当前文档的所有历史状态</a><br/>
		<a href="menu8lesson4.html" title="绘制一条线">绘制一条线</a><br/>
		<a href="menu8lesson5.html" title="给所有文档添加信息">给所有文档添加信息</a><br/>
		<a href="menu8lesson6.html" title="图层批量更名">图层批量更名</a><br/>
		<a href="menu8lesson7.html" title="批量旋转创作艺术效果">批量旋转创作艺术效果</a><br/>
		<a href="menu8lesson8.html" title="给图片批量添加水印">给图片批量添加水印</a><br/>
		<a href="menu8lesson9.html" title="批量自动对比度和自动色阶">批量自动对比度和自动色阶</a><br/>
		<a href="menu8lesson10.html" title="批量生成缩略图">批量生成缩略图</a><br/>
		<a href="menu8lesson11.html" title="批量拼合图片并导出pdf">批量拼合图片并导出pdf</a><br/>
		<a href="menu8lesson12.html" title="批量生成各尺寸的iOS图标">批量生成各尺寸的iOS图标</a><br/>
		<a href="menu8lesson13.html" title="批量生成Web切图">批量生成Web切图</a><br/>
		<a href="menu8lesson14.html" title="批量制作画册模板">批量制作画册模板</a><br/>
		<a href="menu8lesson15.html" title="拼合多张小图为大图并生成小图坐标信息">拼合多张小图为大图并生成小图坐标信息</a><br/>
		<a href="menu8lesson16.html" title="开发一个有趣的Photoshop游戏">开发一个有趣的Photoshop游戏</a><br/>
	</p>
	</div>

<div id="leftMenuAdPart">
		<div class="leftSplitter"></div>
	<div class="myAdsence">
		<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
		<!-- MinorArea1 -->
		<ins class="adsbygoogle"
			 style="display:inline-block;width:200px;height:200px"
			 data-ad-client="ca-pub-5984872709769590"
			 data-ad-slot="1771590269"></ins>
		<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
		</script>
	</div>
<!--
	<div class="leftSplitter"></div>
	<div class="myAdsence">
		<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
		 MinorArea2 
		<ins class="adsbygoogle"
			 style="display:inline-block;width:200px;height:200px"
			 data-ad-client="ca-pub-5984872709769590"
			 data-ad-slot="3248323469"></ins>
		<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
		</script>
	</div>
-->
	</div>
<script>
//document.getElementById('contentTitle').innerHTML = document.title;

var container = document.getElementById('leftMenu');
var links = container.getElementsByTagName('a');

for(var i=0; i<links.length;i++)
{
	if(links[i].innerText == document.title.split(' > ')[1])
	{
		links[i].setAttribute("class","currentLink");
		break;
	}
}
</script>				</div>

				<!--内容开始-->
				<div class="divBodyContentRight">
					<div class="content">
						<div><div class="contentTitle"><h2 id="articleTitle">拼合多张小图为大图并生成小图坐标信息</h2></div><div class="contentShare"><!-- JiaThis Button BEGIN -->
<div class="jiathis_style" style="margin-top:26px;">
<span class="jiathis_txt">&nbsp;&nbsp;&nbsp;&nbsp;</span>
<a class="jiathis_button_qzone"></a>
<a class="jiathis_button_tsina"></a>
<a class="jiathis_button_tqq"></a>
<a class="jiathis_button_renren"></a>
<a class="jiathis_button_kaixin001"></a>
<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
var at = document.getElementById('articleTitle').innerText;

var jiathis_config={
	url:window.location.href,
	summary:"推荐大家一个很棒的【Photoshop脚本】教程网站：http://coolketang.com/。我正在这里学习Ps脚本，这里的课程不仅通俗易懂地讲解了Ps脚本的所有知识点，而且还有大量的Ps脚本综合实例！",
	title:"#酷课堂Photoshop脚本 - "+at+"#",
	shortUrl:false,
	hideMore:false
}
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
<!-- JiaThis Button END --></div></div>
						<hr/><div class="adCloseButtonContainer"><div class="adCloseButton" onclick="closeAd(this)">X</div><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
	 style="display:inline-block;width:728px;height:90px"
	 data-ad-client="ca-pub-5984872709769590"
	 data-ad-slot="7163282668"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
						<div>
							<p>在网页设计、移动开发、3D游戏开发等领域，通常会把项目中用到的小图片拼合成一张大图。好处是降低内存的消耗，减少资源加载次数，从而提高网页、游戏场景等的加载速度。</p>
					<p>首先创建一个空白的脚本文档，并保存在硬盘上某个位置。</p>
					<p>接着输入脚本代码：</p>
<pre>//调用[Folder]的[selectDialog]命令，弹出文件夹选择窗口，提示用户选择所有小图片所在的文件夹，并将文件夹存储在变量[inputFolder]中。
var inputFolder = Folder.selectDialog("选择导入的文件夹：");

//调用[inputFolder]的[getFiles]命令，获取用户选择的文件夹下的所有文件，并且所有文件的数组存储在变量[fileList]中。
var fileList = inputFolder.getFiles();

//定义两个变量[docWidth]和[docHeight]，用来表示拼合后大图的宽度和高度。您也可以计算所有小图的尺寸，从而得出拼合后大图的尺寸。
var docWidth = 2048;
var docHeight = 2048;

//定义三个数组[fileNames], [fileWidths], [fileHeights]，分别用来存储所有小图的名称、宽度和高度。
var fileNames = new Array();
var fileWidths = new Array();
var fileHeights = new Array();

//添加一个循环语句，用来遍历文件夹下的所有文件。
for (var i = 0; i＜fileList.length; i++) 
{
	//调用[app]对象的[open]命令，打开遍历到的文件，并将打开的文件赋予[doc]变量。
	var doc = app.open(fileList[i]);

	//将[doc]对象的路径全称、宽度、高度陆续存储到三个不同的数组里。
	fileNames[i] = doc.fullName;
	fileWidths[i] = parseInt(doc.width);
	fileHeights[i] = parseInt(doc.height);

	//数据存储完成后，关闭该文档即可。
	doc.close();
}
//添加一个循环语句，遍历所有小图片，目的是将这些小图按图片的高度从小到大排列。
//这样把小图合并到大图时，也是按高度从小到大的顺序陆续添加到大图的。
for (var i = fileHeights.length - 1; i > 0; --i) 
{ 
	//添加一个循环语句，这个循环语句和外面的循环语句，构建了一个名叫[冒泡排序]的排序算法。
	for (var j = 0; j ＜ i; ++j) 
	{ 
		//判断如果前面小图的高度，比后面小图的高度大，则执行[swap]函数，交换两个图片在数组中的位置。
		if (fileHeights[j] > fileHeights[j + 1]) 
			swap(j, j + 1); 
	}
}
//新建一个名为[swap]的函数，用来交换两个位置的数据。
function swap(i, j) 
{ 
	//利用一个临时变量[temp]，交换前后位置的图片高度数据。
	var temp = fileHeights[i]; 
	fileHeights[i] = fileHeights[j]; 
	fileHeights[j] = temp; 
    
	//利用一个临时变量[temp2]，交换前后位置的图片宽度数据。
	var temp2 = fileWidths[i]; 
	fileWidths[i] = fileWidths[j]; 
	fileWidths[j] = temp2; 
    
	//利用一个临时变量[temp3]，交换前后位置的图片路径全称数据。
	var temp3 = fileNames[i]; 
	fileNames[i] = fileNames[j]; 
	fileNames[j] = temp3; 
} 
//调用[documents]对象的[add]方法，创建一个设置好宽度和高度的空白文档。
var newDoc = app.documents.add(docWidth, docHeight);

//新建三个变量。
//[currentTop]表示小图在大图上的顶边距
//[currentLeft]表示小图在大图上的左边距
//[locationInfo]表示要输出至文件的所有小图在大图中的坐标信息。
var currentTop = 0;
var currentLeft = 0;
var locationInfo = "";

//添加一个循环，用来遍历所有小图，将它们放置在大图的合适位置上。
for(var i=0; i＜fileNames.length; i++)
{
    //调用[app]对象的[open]命令，打开遍历到的文件，并将打开的文件赋予[doc]变量。
    var doc = app.open(fileNames[i]);

    //调用[doc]对象的[selectAll]命令，全选当前图片，然后执行[copy]命令，将小图拷贝到内存。
    doc.selection.selectAll();
    doc.selection.copy();

    //再把小图的文件名称，添加到[locationInfo]变量中去。所有动作完成后，关闭此文档。
    locationInfo += doc.name+":";
    doc.close();

    //再下来就把拷贝到内存中的小图，粘贴到大图中去。
    //先判断如果小图的宽度加上小图的左边距，是否大于之前设置的最大宽度2048。
    if((currentLeft + fileWidths[i]) > docWidth)
    {
        //如果超过了2048，则把左边距重置为0，则把顶边距改为当前的顶边距与上一张小图的高度的和。
        //这样就可以把当前小图放在大图中下一行的起始位置了。
        currentLeft = 0;
        currentTop = currentTop + fileHeights[i-1];
    }
    //定义一个变量[bounds]，用来计算小图在大图中应放置的区域。
    //四个坐标分别表示小图的左上角、右上角、右下角和左下角坐标。
    var bounds = [[currentLeft, currentTop], 
                          [currentLeft+fileWidths[i], currentTop],
                          [currentLeft+fileWidths[i], currentTop+fileHeights[i]], 
                          [currentLeft, currentTop+fileHeights[i]]];

    //调用[selection]对象的[select]方法，在大图中创建一个基于[bounds]的选区。
    //目的是粘贴小图时，保证小图被准确粘贴在这个位置上。小图默认会被粘贴到大图中心位置上。
    newDoc.selection.select(bounds, SelectionType.REPLACE, 0, true);

    //然后把这个[bounds]变量，添加到[locationInfo]字符串里，[\r\n]表示换行。
    locationInfo += bounds+"\r\n";

    //将图片粘贴到选区里
    newDoc.paste();

    //把刚才拷贝到内存中的小图，粘贴到大图中去，然后把左边距加上当前小图的宽度，作为下张要添加的小图在大图上的左边距。
    currentLeft += fileWidths[i];
}

//调用[Folder]的[selectDialog]命令，弹出文件夹选择窗口，提示用户选择大图和文本文件要输出的文件夹。
var destFolder = Folder.selectDialog( "请选择一个输出的文件夹：");

//定义一个变量[option]，表示导出大图的存储格式。
var option = new PNGSaveOptions();

//设置[option]对象的[PNG8]属性为false，保证导出的大图不被压缩。您也可以根据情况，设置导出为压缩模式。
option.PNG8 = false;

//定义一个变量[file]，表示将要导出的大图文件。
var file = new File(destFolder + "/combined.png");

//然后调用[newDoc]的[saveAs]方法，将大图保存到设置好路径的文件夹下。
newDoc.saveAs(file, option, true, Extension.LOWERCASE);

//定义一个变量[fileOut]，表示将要导出的文本文件。这个文本文件存储了所有小图在大图中的坐标信息。
var fileOut = new File(destFolder + "/combined.log");

//将坐标信息[locationInfo]写入文本文件。
fileOut.open("w", "TEXT", "????");
fileOut.write(locationInfo);

//写入完成后，调用[fileOut]对象的[close]方法，关闭文本输出流。
fileOut.close();
</pre>
					<p><img src="../screens/menu8lesson15_34.png" width="760px"/></p>
					<p>我们的脚本已经编写完成，把它保存下来。</p>
					<p>然后切换到Photoshop。</p>
					<p><img src="../screens/menu8lesson15_35.png" width="760px"/></p>
					<p>接着依次点击[文件] > [脚本] > [浏览]，打开刚刚保存的脚本文件。</p>
					<p><img src="../screens/menu8lesson15_36.png" width="760px"/></p>
					<p>在弹出的[载入]窗口中，直接双击脚本名称，Photoshop将直接调用并执行该脚本。</p>
					<p><img src="../screens/menu8lesson15_38.png" width="760px"/></p>
					<p>点击选择需要合并的图片所在的文件夹。然后点击[确定]按钮，确认文件夹的选择。</p>
					<p><img src="../screens/menu8lesson15_39.png" width="760px"/></p>
					<p>点击选择合并后的大图需要导出到的文件夹。然后点击[确定]按钮，确认文件夹的选择。</p>
					<p><img src="../screens/menu8lesson15_40.png" width="760px"/></p>
					<p>上图为合并后的图片。现在打开资源管理器，跳转到导出后的文件夹，查看导出后的大图和坐标信息文本文件。</p>
					<p><img src="../screens/menu8lesson15_41.png" width="760px"/></p>
					<p>在文本文件中双击，使用记事本打开文本文件，查看各小图的坐标信息。</p>
					<p><img src="../screens/menu8lesson15_42.png" width="760px"/></p>
							<p></p>

						</div>
					</div>
				</div>
				<!--内容结束-->
			</div>
		</div>
		
		<!--底部开始-->
		<div class="divFoot">
	<div class="divFootContent">
		<br/>
		酷课堂 提供的内容仅用于培训。我们不保证内容的正确性。
		通过使用本站内容随之而来的风险与本站无关。
		酷课堂简体中文版的所有内容仅供测试，对任何法律问题及风险不承担任何责任。
		当使用本站时，代表您已接受了本站的使用条款和隐私条款。
		版权所有，保留一切权利。 
		<br/>赞助商：<a href="http://weibo.com/tapinfinity" target="_blank">TapInfinity</a>
		<br/>
		<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1253561512'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s95.cnzz.com/stat.html%3Fid%3D1253561512%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));</script>

	</div>
</div>		<!--底部结束-->

	</body>
</html>